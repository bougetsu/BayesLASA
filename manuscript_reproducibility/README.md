# Reproduce BayesLASA manuscript

This folder contains the scripts and data to reproduce the figures and tables related to the analysis in the manuscript "Bayesian Landmark-based Shape Analysis of Tumor Pathology Images".

### Folder structure

* `src`: scripts to reproduce the corresponding figure or tables. Names as `FigX.R`. `sim_generate.R` contains the codes to generate the simulated polygonal chains and run BayesLASA. It takes quite a long time to run and the read-to-use results are stored in the `data/simulated_data` folder.

* `data`: data to reproduce the analysis

  * `demo_data_mpeg7_deer`: deer application case from MPEG7 dataset.
  
  * `real_data_pathology_images`: pathology images of lung cancer patients
    
    * `Processed`: polygonal chains of tumor region from pathology images. The raw tumor pathology images from the National Lung Screening Trial (NLST) are available at https://cdas.cancer.gov/datasets/nlst/
    
    * `Summary_statistics`: roughness measurement results including distanced-based and model-based
    
    * `Radius_based`: results of tumor roughness boundary measurement
    
  * `real_data_us_state`: maps of United States
  

  * `simulated_data`: simulation dataset of polygonal chain
  
    * `Polygon`: polygonal chains generated for simulation from `src/sim_generate.R`, each polygon object contains `original_dat` with `x`, `y` coordinates, `gamma` and `sigma`; `normalized` polygon with perimeter = 1.
    
    * `Sensitivity`: ready-to-use BayesLASA results for sensitivity analysis, generated by `src/FigS7-S8.R`.
    
    * `Summary_statistics`: results of MCC and ARI

* `figs_tabs`: output folder saving the figures and tables.

Under each data case folder in the `data`, there may contain several of the following subfolders:

* `raw`: raw data with the `x` and `y` coordinates of the polygon chain

* `BayesLASA`: ready-to-use result of BayesLASA

* `ALDUQ`: ready-to-use result of [ALDUQ](https://github.com/jd-strait/ALDUQ) method from the manuscript "Automatic Detection and Uncertainty Quantification of Landmarks on Elastic Curves"  (https://www.tandfonline.com/doi/full/10.1080/01621459.2018.1527224)

* `Chull`: ready-to-use result of convex hull


### Reproduce analysis

To reproduce the figure or table in the manuscript, e.g., `Figure 3`. We just need to run `source("manuscript_reproducibility/src/Fig3.R")` from the repo root. And the corresponding figure will be
saved in `figs_tabs`.

Some scripts also contains the steps to run `BayesLASA` or `Convex hull` on the dataset for landmark identification. Since the MCMC process takes a while to complete, the ready-to-use results are already saved in the `BayesLASA` sub-folder under each data case folder.



