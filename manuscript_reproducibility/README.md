# Reproduce BayesLASA manuscript

This folder contains the scripts and data to reproduce the figures and tables related to the analysis in the manuscript "Bayesian Landmark-based Shape Analysis of Tumor Pathology Images".

### Folder structure

* `scripts`: scripts to reproduce the corresponding figure or tables. Names as `figure_X.R` or `table_X.R`. 

* `results`: processed data to reproduce the analysis, usually the output of BayesLASA, ALDUQ and Convex hull.

  * `demo_data_mpeg7_deer`: deer application case from MPEG7 dataset.
  
  * `real_data_pathology_images`: pathology images of lung cancer patients
  
    * `run_BayesLASA_pathology.R`: script to read input data and run BayesLASA to generate the output in the corresponding `BayesLASA`. Calculated distance-based and model-based roughness measurements in `summary_statistics`
    
    * `summary_statistics`: roughness measurement results including distanced-based and model-based
    
  * `real_data_us_state`: maps of United States

  * `simulated_data`: simulation dataset of polygonal chain
    
    * `run_BayesLASA.R`: script to read simulated data and run BayesLASA and convex hull to generate the output in the corresponding `BayesLASA` and `Chull` folders as well as get the recored runtime saved in `MCMC_time_table.csv` and `Chull_time_table.csv`.
    
    * `Sensitivity`: ready-to-use BayesLASA results for sensitivity analysis, generated by `scripts/figure_s7.R` or `scripts/figure_s8.R`.
    
    * `Summary_statistics`: ready-to-use results of MCC and ARI

* `figures_and_tables`: output folder saving the figures and tables.

Under each data case folder in the `data`, there may contain several of the following subfolders:

* `BayesLASA`: ready-to-use result of BayesLASA

* `ALDUQ`: ready-to-use result of [ALDUQ](https://github.com/jd-strait/ALDUQ) method from the manuscript "Automatic Detection and Uncertainty Quantification of Landmarks on Elastic Curves"  (https://www.tandfonline.com/doi/full/10.1080/01621459.2018.1527224)

* `Chull`: ready-to-use result of convex hull

* `Radius_based`: results of tumor roughness boundary measurement

### Reproduce analysis

To reproduce the figure or table in the manuscript, e.g., `Figure 3`. We just need to run `source("manuscript_reproducibility/scripts/figure_3.R")` from the repo root. And the corresponding figure will be
saved in `figures_and_tables`.

Some scripts also contains the steps to run `BayesLASA` or `Convex hull` on the dataset for landmark identification. Since the MCMC process takes a while to complete, the ready-to-use results are already saved in the `BayesLASA` sub-folder under each data case folder.



