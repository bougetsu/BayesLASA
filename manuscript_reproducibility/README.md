## Reproduce BayesLASA manuscript

This folder contains the scripts and data to reproduce the figures and tables that depict the analysis in the manuscript "Bayesian Landmark-based Shape Analysis of Tumor Pathology Images".

### Directory structure

* `scripts`: Scripts to reproduce the corresponding figure or tables; file names follow the pattern `figure_X.R` or `table_X.R`. 
* `results`: Processed data to reproduce the analysis; usually the output of BayesLASA, ALDUQ, and convex hull.
  * `demo_data_mpeg7_deer`: Analysis of a deer shape from the MPEG-7 dataset.
  * `real_data_pathology_images`: Pathology images from lung cancer patients.
    * `run_BayesLASA_pathology.R`: Script to read dataset and run BayesLASA to generate the output in the corresponding `BayesLASA` folder.  Distance-based and model-based roughness measurements are calculated and provided in `summary_statistics`.
    * `summary_statistics`: Roughness measurement results, including distanced-based and model-based.
  * `real_data_us_state`: Map of the of 48 contiguous United States.
  * `simulated_data`: Simulated polygonal chain dataset.
    * `run_BayesLASA.R`: Script to read simulated dataset and run BayesLASA and convex hull to generate the output in the corresponding `BayesLASA` and `Chull` folders; script runtime is saved in `MCMC_time_table.csv` and `Chull_time_table.csv`.
    * `sensitivity`: Ready-to-use BayesLASA results for sensitivity analysis, generated by `scripts/figure_s7.R` or `scripts/figure_s8.R`.
    * `summary_statistics`: Ready-to-use MCC and ARI results.
* `figures_and_tables`: Output folder saving the figures and tables.

Within each dataset folder in the main `data` folder, there may be several of the following subfolders:

* `BayesLASA`: Ready-to-use BayesLASA output.
* `ALDUQ`: Ready-to-use [ALDUQ](https://github.com/jd-strait/ALDUQ) output [(ALDUQ is from the manuscript "Automatic Detection and Uncertainty Quantification of Landmarks on Elastic Curves")](https://www.tandfonline.com/doi/full/10.1080/01621459.2018.1527224).
* `Chull`: Ready-to-use convex hull output.
* `Radius_based`: Tumor roughness boundary measurement results.

### Reproduce analysis

To reproduce a figure or table in the manuscript, e.g., `Figure 3`, run `source("manuscript_reproducibility/scripts/figure_3.R")` from the repo root; the corresponding figure will be saved in `figures_and_tables`.

Some scripts also contain the steps to run `BayesLASA` or `Convex hull` on a dataset for landmark identification. Since the MCMC process will take a while to complete, we provide ready-to-use results in the corresponding `BayesLASA` subfolder under each dataset folder.
