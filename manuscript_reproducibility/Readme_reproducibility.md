# Reproduce BayesLASA manuscript

This folder contains the scripts and data to reproduce the figures and tables related to the analysis in the manuscript "Bayesian Landmark-based Shape Analysis of Tumor Pathology Images".

### Folder structure

* `code`: scripts to reproduce the corresponding figure or tables. Names as `FigX.R`.

* `data`: data to reproduce the analysis

  * `demo_data_mpeg7_deer`: deer application case from MPEG7 dataset.
  
  * `real_data_pathology_images`: pathology images of lung cancer patients
  
  * `real_data_us_state`: maps of United States
  
    * `processed`: polygonal chain from XXX.
    
    * `Summary_statistics`: roughness measurement results including distanced-based and model-based
    
    * `Radius_based`: results of tumor roughness boundary measurement
    
  * `simulated_data`: simulation dataset of polygonal chain
  
    * `Polygon`: polygonal chains generated for simulation, each polygon object contains `original_dat` with `x`, `y` coordinates, `gamma` and `sigma`; `normalized` polygon with perimeter = 1.
    
    * `Sensitivity`: ready-to-use BayesLASA results for sensitivity analysis, generated by `code/FigS7-S8.R`.
    
    * `Summary_statistics`: results of MCC and ARI

* `figs_tabs`: output folder saving the figures and tables.

Under each data case folder in the `data`, there may contain several of the following subfolders:

* `raw`: raw data with the `x` and `y` coordinates of the polygon chain

* `BayesLASA`: ready-to-use result of BayesLASA

* `ALDUQ`: ready-to-use result of ALDUQ 

* `chull`: ready-to-use result of convex hull


### Reproduce analysis

To reproduce the figure or table in the manuscript, e.g., `Figure 3`. We just need to run `source("manuscript_reproducibility/code/Fig3.R")` from the repo root. And the corresponding figure will be
saved in `figs_tabs`.

Some scripts also contains the steps to run `BayesLASA` or `Convex hull` on the dataset for landmark identification. Since the MCMC process takes a while to complete, the ready-to-use results are already saved in the `BayesLASA` sub-folder under each data case folder.



